webpackJsonp([13],{"8d1T":function(t,e){},NrMZ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),n=a.n(s),o=a("XiPb"),i=a("mYEk"),c=a("P9l9"),l=(a("zL8q"),a("mtWM")),r=a.n(l),u={data:function(){return{name:"商品管理",productName:"",product_data:[],total_page:0,current_page:1,total_num:0,page_size:10,checkRow:[],show_modal:!1,one_product:[],check_data:[]}},components:{pageTitle:o.a,Pagination:i.a},mounted:function(){this.getData()},computed:{},methods:{freshClick:function(){console.log("fresh")},topSearch:function(){this.getData(1,this.productName)},filterTag:function(t,e){return""==t?e.PRstaus==e.PRstaus:e.PRstaus===t},changeFun:function(t){for(var e=[],a=0;a<t.length;a++)e.push(t[a].PRid);this.check_data[this.current_page-1]=[].concat(e);for(var s=[],o=JSON.parse(n()(this.check_data)),i=0;i<o.length;i++)s=s.concat(o[i]);this.checkRow=[].concat(s)},editClick:function(t){this.$router.push("/commodity/goodsImported?PRid="+t.PRid)},checkClick:function(){},showModal:function(t){this.show_modal=t},importProduct:function(){this.updateProduct("在售状态")},soldOut:function(){var t=this;this.$confirm("确认将选中商品下架?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.updateProduct("下架状态")}).catch(function(){})},deleteProduct:function(){var t=this;this.$confirm("确认将选中商品删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.updateProduct("删除状态")}).catch(function(){})},updateProduct:function(t){var e=this,a=[].concat(this.checkRow),s=this;if(this.checkRow.length<1)return this.$message({message:"请先选择商品",type:"warning"}),!1;var n={PRid:a,PRstatus:t};r.a.post(c.a.update_product+"?token="+localStorage.getItem("token"),n).then(function(t){200==t.data.status&&(e.$message({message:t.data.message,type:"success"}),s.getData())})},getData:function(t,e){var a=this,s=this,n={token:localStorage.getItem("token"),PRstatus:"",page_num:t||this.current_page,page_size:this.page_size,product_filter:e};r.a.get(c.a.get_all_product,{params:n}).then(function(t){if(200==t.data.status){a.product_data=t.data.data.products;for(var e=function(t){-1!=a.checkRow.indexOf(a.product_data[t].PRid)&&s.$nextTick(function(){s.$refs.table.toggleRowSelection(s.product_data[t],!0)})},n=0;n<a.product_data.length;n++)e(n);a.total_num=t.data.data.count,a.total_page=Math.ceil(a.total_num/a.page_size)}else a.$message.error(t.data.message)},function(t){a.$message.error(t.data.message)})},pageChange:function(t){if(t==this.current_page)return this.$message({message:"这已经是第"+t+"页数据了",type:"warning"}),!1;this.current_page=t,this.getData(t)}},created:function(){}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-user"},[a("page-title",{attrs:{title:t.name},on:{freshClick:t.freshClick}}),t._v(" "),a("div",{staticClass:"m-content"},[a("div",{staticClass:"m-top"},[a("div",{staticClass:"m-top-search"},[a("div",{staticClass:"m-top-text"},[t._v("商品名称：")]),t._v(" "),a("el-input",{staticClass:"m-input-m",model:{value:t.productName,callback:function(e){t.productName=e},expression:"productName"}}),t._v(" "),a("el-button",{staticClass:"m-top-search-button",attrs:{size:"mini"},on:{click:t.topSearch}},[t._v("查询")])],1),t._v(" "),a("div",{staticClass:"m-top-button"},[a("el-button",{staticClass:"m-top-button-button",attrs:{size:"mini"},on:{click:t.importProduct}},[t._v("发布商品")])],1)]),t._v(" "),a("div",{staticClass:"m-middle",staticStyle:{width:"100%","margin-top":"0.1rem"}},[a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:t.product_data,stripe:""},on:{"selection-change":t.changeFun}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"PRimage",label:"商品",width:"125"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{staticClass:"m-table-img",attrs:{src:t.row.PRimage[0]}})]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"PRname",label:"名称"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"PRsalesvolume",label:"库存"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:0==e.row.PRsalesvolume?"m-alert":""},[t._v(t._s(e.row.PRsalesvolume))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"PRsalesvolume",label:"总销量"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"PRtime",width:"160",label:"创建时间"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"PRstatus",label:"状态概况",filters:[{text:"全部",value:""},{text:"预售状态",value:"预售状态"},{text:"在售状态",value:"在售状态"},{text:"未发布",value:"未发布"},{text:"下架状态",value:"下架状态"}],"filter-method":t.filterTag},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:"全部售罄"==e.row.PRstatus?"m-alert":""},[t._v(t._s(e.row.PRstatus))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:" m-table-link",on:{click:function(a){t.editClick(e.row)}}},[t._v("编辑")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"m-bottom"},[a("div",{staticClass:"m-bottom-btn-box"},[a("el-button",{staticClass:"m-bottom-btn m-btm-cancel",attrs:{size:"mini"},on:{click:t.soldOut}},[t._v("下架")]),t._v(" "),a("el-button",{staticClass:"m-bottom-btn ",attrs:{size:"mini"},on:{click:t.deleteProduct}},[t._v("删除")])],1),t._v(" "),a("div",{staticClass:"page-button"},[a("Pagination",{attrs:{total:t.total_page},on:{pageChange:t.pageChange}})],1)])]),t._v(" "),a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.show_modal,expression:"show_modal"}],staticClass:"m-modal"},[a("div",{staticClass:"m-modal-state"},[a("div",{staticClass:"m-modal-head m-flex-between"},[a("span",[t._v("商品详情")]),t._v(" "),a("span",{staticClass:"m-close",on:{click:function(e){t.showModal(!1)}}},[t._v("X")])]),t._v(" "),a("div",{staticClass:"m-modal-content"},[a("div",{staticClass:"m-middle",staticStyle:{width:"100%","margin-top":"0.1rem"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.one_product,stripe:""}},[a("el-table-column",{attrs:{align:"center",prop:"userId",width:"400",label:"宝贝描述"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"m-production-description"},[a("p",{staticClass:"m-img"}),t._v(" "),a("div",[a("p",[t._v("商品1")]),t._v(" "),a("p",[t._v("ID:5489798456151241")])])])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"userId",label:"价格"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"loginTime",label:"库存"}})],1)],1),t._v(" "),a("div",{staticClass:"m-page-box"},[a("pagination",{attrs:{total:0},on:{pageChange:t.pageChange}})],1)])])])])],1)},staticRenderFns:[]};var m=a("VU/8")(u,d,!1,function(t){a("8d1T")},"data-v-8dd63a88",null);e.default=m.exports}});
//# sourceMappingURL=13.33ceae67b71389b65bbe.js.map